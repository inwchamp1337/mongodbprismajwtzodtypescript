{
    "openapi": "3.0.0",
    "info": {
        "title": "Movie Review API",
        "version": "1.0.0",
        "description": "API documentation for the Movie Review application."
    },
    "servers": [
        {
            "url": "http://localhost:3001/api"
        }
    ],
    "components": {
        "securitySchemes": {
            "BearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT",
                "description": "Enter your token. Example: Bearer eyJhbGciOiJIUzI1NiIs..."
            }
        },
        "schemas": {
            "Register": {
                "type": "object",
                "required": [
                    "email",
                    "password",
                    "username",
                    "profile"
                ],
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "description": "อีเมลของผู้ใช้ (ต้องไม่ซ้ำ)"
                    },
                    "password": {
                        "type": "string",
                        "minLength": 6,
                        "description": "รหัสผ่าน (อย่างน้อย 6 ตัวอักษร)"
                    },
                    "username": {
                        "type": "string",
                        "minLength": 3,
                        "description": "ชื่อผู้ใช้ (ต้องไม่ซ้ำ)"
                    },
                    "profile": {
                        "type": "object",
                        "required": [
                            "fullName",
                            "birthday"
                        ],
                        "properties": {
                            "fullName": {
                                "type": "string",
                                "minLength": 2,
                                "description": "ชื่อเต็มของผู้ใช้"
                            },
                            "avatarUrl": {
                                "type": "string",
                                "format": "uri",
                                "description": "URL ของรูปโปรไฟล์ (optional)"
                            },
                            "bio": {
                                "type": "string",
                                "description": "คำอธิบายสั้น ๆ เกี่ยวกับผู้ใช้ (optional)"
                            },
                            "birthday": {
                                "type": "string",
                                "format": "date-time",
                                "description": "วันเกิดของผู้ใช้"
                            }
                        }
                    }
                }
            },
            "Login": {
                "type": "object",
                "required": [
                    "email",
                    "password"
                ],
                "properties": {
                    "email": {
                        "type": "string",
                        "format": "email",
                        "description": "อีเมลสำหรับเข้าสู่ระบบ"
                    },
                    "password": {
                        "type": "string",
                        "minLength": 6,
                        "description": "รหัสผ่าน"
                    }
                }
            },
            "Profile": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string",
                        "description": "Profile ID"
                    },
                    "fullName": {
                        "type": "string",
                        "description": "ชื่อเต็มของผู้ใช้"
                    },
                    "avatarUrl": {
                        "type": "string",
                        "format": "uri",
                        "description": "URL ของรูปโปรไฟล์"
                    },
                    "bio": {
                        "type": "string",
                        "description": "คำอธิบายสั้น ๆ เกี่ยวกับผู้ใช้"
                    },
                    "birthday": {
                        "type": "string",
                        "format": "date-time",
                        "description": "วันเกิดของผู้ใช้"
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time",
                        "description": "วันที่สร้างโปรไฟล์"
                    },
                    "user": {
                        "type": "object",
                        "properties": {
                            "id": {
                                "type": "string"
                            },
                            "username": {
                                "type": "string"
                            },
                            "email": {
                                "type": "string",
                                "format": "email"
                            }
                        }
                    }
                }
            },
            "Movie": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string",
                        "description": "Movie ID"
                    },
                    "title": {
                        "type": "string",
                        "description": "ชื่อภาพยนตร์"
                    },
                    "description": {
                        "type": "string",
                        "description": "รายละเอียดภาพยนตร์"
                    },
                    "releaseDate": {
                        "type": "string",
                        "format": "date-time",
                        "description": "วันที่เข้าฉาย"
                    },
                    "genre": {
                        "type": "string",
                        "description": "ประเภทของภาพยนตร์"
                    }
                }
            },
            "CreateMovie": {
                "type": "object",
                "required": [
                    "title",
                    "description",
                    "releaseDate",
                    "genre"
                ],
                "properties": {
                    "title": {
                        "type": "string",
                        "description": "ชื่อภาพยนตร์"
                    },
                    "description": {
                        "type": "string",
                        "description": "รายละเอียดภาพยนตร์"
                    },
                    "releaseDate": {
                        "type": "string",
                        "format": "date-time",
                        "description": "วันที่เข้าฉาย"
                    },
                    "genre": {
                        "type": "string",
                        "description": "ประเภทของภาพยนตร์"
                    }
                }
            },
            "UpdateMovie": {
                "type": "object",
                "properties": {
                    "title": {
                        "type": "string",
                        "description": "ชื่อภาพยนตร์"
                    },
                    "description": {
                        "type": "string",
                        "description": "รายละเอียดภาพยนตร์"
                    },
                    "releaseDate": {
                        "type": "string",
                        "format": "date-time",
                        "description": "วันที่เข้าฉาย"
                    },
                    "genre": {
                        "type": "string",
                        "description": "ประเภทของภาพยนตร์"
                    }
                }
            },
            "ErrorResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": false
                    },
                    "message": {
                        "type": "string",
                        "example": "Error message"
                    }
                }
            },
            "AuthResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": true
                    },
                    "data": {
                        "type": "object",
                        "properties": {
                            "token": {
                                "type": "string",
                                "description": "JWT Token"
                            },
                            "user": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "string"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email"
                                    },
                                    "username": {
                                        "type": "string"
                                    },
                                    "profile": {
                                        "$ref": "#/components/schemas/Profile"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "paths": {
        "/auth/register": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Register a new user",
                "description": "Create a new user account with profile",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/Register"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "User registered successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AuthResponse"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Email or username already exists",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid input data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Registration failed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/login": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Login a user",
                "description": "Authenticate user and get access token",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/Login"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AuthResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Login failed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/profiles": {
            "get": {
                "tags": [
                    "Profile"
                ],
                "summary": "Get all profiles",
                "description": "Retrieve a list of all user profiles (admin only)",
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of all profiles",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Profile"
                                            }
                                        }
                                    }
                                },
                                "example": {
                                    "success": true,
                                    "data": [
                                        {
                                            "id": "6819c43d24a05c28d379c3fb",
                                            "fullName": "John Doe",
                                            "avatarUrl": "https://example.com/avatar.jpg",
                                            "bio": "Movie enthusiast",
                                            "birthday": "1990-01-01T00:00:00.000Z",
                                            "createdAt": "2023-12-01T10:00:00.000Z",
                                            "user": {
                                                "id": "6819c43d24a05c28d379c3fb",
                                                "username": "johndoe",
                                                "email": "john@example.com"
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/profiles/me": {
            "get": {
                "tags": [
                    "Profile"
                ],
                "summary": "Get my profile",
                "description": "Retrieve the profile of the currently authenticated user",
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Current user's profile",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Profile"
                                        }
                                    }
                                },
                                "example": {
                                    "success": true,
                                    "data": {
                                        "id": "6819c43d24a05c28d379c3fb",
                                        "fullName": "John Doe",
                                        "avatarUrl": "https://example.com/avatar.jpg",
                                        "bio": "Movie enthusiast",
                                        "birthday": "1990-01-01T00:00:00.000Z",
                                        "createdAt": "2023-12-01T10:00:00.000Z",
                                        "user": {
                                            "id": "6819c43d24a05c28d379c3fb",
                                            "username": "johndoe",
                                            "email": "john@example.com"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Profile not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/profiles/{id}": {
            "get": {
                "tags": [
                    "Profile"
                ],
                "summary": "Get profile by ID",
                "description": "Retrieve a specific profile by its ID",
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "description": "Profile ID",
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Profile details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Profile"
                                        }
                                    }
                                },
                                "example": {
                                    "success": true,
                                    "data": {
                                        "id": "6819c43d24a05c28d379c3fb",
                                        "fullName": "John Doe",
                                        "avatarUrl": "https://example.com/avatar.jpg",
                                        "bio": "Movie enthusiast",
                                        "birthday": "1990-01-01T00:00:00.000Z",
                                        "createdAt": "2023-12-01T10:00:00.000Z",
                                        "user": {
                                            "id": "6819c43d24a05c28d379c3fb",
                                            "username": "johndoe",
                                            "email": "john@example.com"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Profile not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/movies": {
            "get": {
                "tags": [
                    "Movies"
                ],
                "summary": "Get all movies",
                "description": "Retrieve a list of all movies",
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of movies",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Movie"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Movies"
                ],
                "summary": "Create a new movie",
                "description": "Add a new movie to the database",
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateMovie"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Movie created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Movie"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid input data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "$ref": "#/components/schemas/ErrorResponse"
                            }
                        }
                    }
                }
            }
        },
        "/movies/{id}": {
            "get": {
                "tags": [
                    "Movies"
                ],
                "summary": "Get movie by ID",
                "description": "Retrieve a specific movie by its ID",
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Movie details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Movie"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Movie not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "tags": [
                    "Movies"
                ],
                "summary": "Update a movie",
                "description": "Update an existing movie's information",
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpdateMovie"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Movie updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/Movie"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid input data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Movie not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "tags": [
                    "Movies"
                ],
                "summary": "Delete a movie",
                "description": "Delete an existing movie",
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Movie deleted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Movie deleted successfully"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Movie not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
